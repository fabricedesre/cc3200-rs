# We install rust ourselves because travis doesn't use rustup yet and that
# prevents installation of the rust-src component.

addons:
    apt:
    packages:
      - gcc-arm-none-eabi

script:
  - curl https://sh.rustup.rs -sSf -o rustup.sh
  - chmod +x ./rustup.sh
  - ./rustup.sh -y --channel nightly
  - /home/travis/.cargo/bin/rustup component add rust-src
  - /home/travis/.cargo/bin/cargo install xargo
  - ls -lRa .cargo/
  - PATH=/home/travis/.cargo/bin:$PATH ./build.sh
  - PATH=/home/travis/.cargo/bin:$PATH ./build.sh --release
